var P=Object.defineProperty,S=Object.defineProperties;var q=Object.getOwnPropertyDescriptors;var l=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var f=(e,r,t)=>r in e?P(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,m=(e,r)=>{for(var t in r||(r={}))E.call(r,t)&&f(e,t,r[t]);if(l)for(var t of l(r))A.call(r,t)&&f(e,t,r[t]);return e},w=(e,r)=>S(e,q(r));var N=(e,r)=>{var t={};for(var n in e)E.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&l)for(var n of l(e))r.indexOf(n)<0&&A.call(e,n)&&(t[n]=e[n]);return t};import{I as v,d as x,b as y,S as F,P as R,r as U,H as B,A as C}from"./vendor.75aab190.js";const H=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))n(c);new MutationObserver(c=>{for(const a of c)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(c){const a={};return c.integrity&&(a.integrity=c.integrity),c.referrerpolicy&&(a.referrerPolicy=c.referrerpolicy),c.crossorigin==="use-credentials"?a.credentials="include":c.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(c){if(c.ep)return;c.ep=!0;const a=t(c);fetch(c.href,a)}};H();let L=1;function d(e,r,t){const n=window.ReactNativeWebView;return new Promise((c,a)=>{n.postMessage(JSON.stringify({action:e,data:r,_cb:L,info:t}));const o=function(s){const{status:h}=s.detail;return h==="success"?c(s.detail):a(s.detail)};window.addEventListener(`dapp_${e}`,o,{capture:!0,once:!0})})}const D=(e,r)=>{var t;return!!((e==null?void 0:e.canisterId)&&(e==null?void 0:e.methodName)&&(e==null?void 0:e.arguments)&&((t=r[e.canisterId])==null?void 0:t[e.methodName]))},O=(e,r)=>{if(D(e,r)){const t=e,n=r[t.canisterId][t.methodName];return x(n,t.arguments)}},W=new TextDecoder,G=(e,r,t=!1)=>async(n,c)=>{const a=new Uint8Array(n);return c&&(c.decodedArguments=c.arguments?O(c,e):[]),(await d("requestSign",[a,r,w(m({},c),{arguments:W.decode(c.arguments),preApprove:t})])).result.data},X=e=>{const r=e({IDL:v}),t={};return r._fields.forEach(([n,c])=>t[n]=c.argTypes),t},T=["https://mainnet.dfinity.network","ic0.app"];function Y(...e){const r=new Uint8Array(e.reduce((n,c)=>n+c.byteLength,0));let t=0;for(const n of e)r.set(new Uint8Array(n),t),t+=n.byteLength;return r}const z=y.Buffer.from(new TextEncoder().encode(`
ic-request`));class M extends F{constructor(r,t,n){super();this.signCb=t,this.publicKey=r,this.signCb=t,this.whitelist=n||[]}getPublicKey(){return this.publicKey}async sign(r,t){return await this.signCb(r,{sender:(t==null?void 0:t.sender)&&R.from(t.sender).toString(),methodName:t==null?void 0:t.method_name,requestType:t==null?void 0:t.request_type,canisterId:(t==null?void 0:t.canister_id)&&R.from(t.canister_id).toString(),arguments:t==null?void 0:t.arg,manual:!1})}async transformRequest(r){const a=r,{body:t}=a,n=N(a,["body"]),c=await U(t);return w(m({},n),{body:{content:t,sender_pubkey:this.getPublicKey().toDer(),sender_sig:await this.sign(Y(z,c),t)}})}}function V(e){return y.Buffer.from(e,"hex")}function g(e){return y.Buffer.from(e)}const i=class{static fromRaw(e){return new i(e)}static fromDer(e){return new i(this.derDecode(e))}static from(e){return this.fromDer(e.toDer())}static derEncode(e){if(e.byteLength!==i.RAW_KEY_LENGTH){const t=e.byteLength;throw new TypeError(`secp256k1 public key must be ${i.RAW_KEY_LENGTH} bytes long (is ${t})`)}const r=Uint8Array.from([...i.DER_PREFIX,...new Uint8Array(e)]);return g(r)}static derDecode(e){const r=i.DER_PREFIX.length+i.RAW_KEY_LENGTH;if(e.byteLength!==r){const n=e.byteLength;throw new TypeError(`secp256k1 DER-encoded public key must be ${r} bytes long (is ${n})`)}const t=g(e.subarray(i.DER_PREFIX.length));if(!this.derEncode(t).equals(e))throw new TypeError(`secp256k1 DER-encoded public key is invalid. A valid secp256k1 DER-encoded public key must have the following prefix: ${i.DER_PREFIX}`);return t}constructor(e){this.rawKey=e,this.derKey=i.derEncode(e)}toDer(){return this.derKey}toRaw(){return this.rawKey}};let b=i;b.RAW_KEY_LENGTH=65;b.DER_PREFIX=Uint8Array.from([48,86,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,10,3,66,0]);const J=T[0],k={whitelist:[],host:J},j=async(e,{whitelist:r=k.whitelist,host:t=k.host},n,c=!1)=>{const a=b.fromRaw(V(e)),o=new M(a,G(n,{host:t,name:"host"},c),r),s=new B({identity:o,host:t});return T.includes(t)||await s.fetchRootKey(),s},Q=async(e,r,t)=>C.createActor(t,{agent:e,canisterId:r});window.Buffer=window.Buffer||y.Buffer;let _,p;const K=[];var u={get webview(){return window.ReactNativeWebView},get publicKey(){return p},setPublickKey(e){p=e},check:function(){return"ReactNativeWebView"in window},isConnected:function(){return d("isConnected",{})},authorize:function(e){return e.host=location.host,e.icon=e.icon||location.origin+"/favicon.ico",d("authorize",e)},pay:function(e){return e.host=e.host||location.host,e.icon=e.icon||location.origin+"/favicon.ico",e.fee=e.fee||"10000",d("pay",e)},async createActor({canisterId:e,interfaceFactory:r}){return K[e]=X(r),_||(_=await j(p,{whitelist:[e]},K)),Q(_,e,r)},disConnect(){return d("disConnect",{host:location.host})}};window.global=window;(async function(){const e=async function(){const c=await u.isConnected();document.getElementById("status-connect").innerText=c?"connectd":"not connected"},r=async function(){try{const c=await u.authorize({canisters:["quctq-dsfdf-asdfs-dsfds-asd","quctq-dsfdf-asdfs-dsfds-a2d"]});u.setPublickKey(c.publicKey),console.log("auth ok: ",c,u.publicKey)}catch(c){console.log("error: ",c)}},t=async function(){const c="qoctq-giaaa-aaaaa-aaaea-cai",a=({IDL:o})=>{const s=o.Nat64,h=o.Record({latest_transaction_block_height:s,seconds_since_last_ledger_sync:o.Nat64,sub_accounts_count:o.Nat64,hardware_wallet_accounts_count:o.Nat64,accounts_count:o.Nat64,earliest_transaction_block_height:s,transactions_count:o.Nat64,block_height_synced_up_to:o.Opt(o.Nat64),latest_transaction_timestamp_nanos:o.Nat64,earliest_transaction_timestamp_nanos:o.Nat64});return o.Service({get_stats:o.Func([],[h],["query"])})};try{const s=await(await u.createActor({canisterId:c,interfaceFactory:a})).get_stats();console.log("NNS stats",s)}catch(o){console.log("error: ",o)}},n=async function(){try{const c=await u.pay({amount:"0.01",to:"icpnftfi.icp",memo:"392432"})}catch(c){console.log(c)}};$("document").ready(function(){$("#check").on("click",e),$("#auth").on("click",r),$("#buy").on("click",n),$("#call-canister").on("click",t)})})();
